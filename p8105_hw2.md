P8105_hw2
================
Nhu Nguyen
2023-09-27

load necessary libraries

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

## problem 1

importing and cleaning dataset

``` r
pols_month = 
  read_csv("./fivethirtyeight_datasets/pols-month.csv") %>% 
  separate(mon, into = c("year", "month", "day")) %>% 
  mutate(month = recode(month, `01` = "Jan", `02` = "Feb", `03` = "Mar", `04` = "Apr", `05` = "May", `06` = "Jun", `07` = "Jul", `08` = "Aug", `09` = "Sep", `10` = "Oct", `11` = "Nov", `12` = "Dec")) %>% 
  mutate(president = case_when(
    prez_dem == 1 ~ "dem",
    prez_gop == 1 ~ "gop"
  )) %>% 
  select(-prez_dem, -prez_gop, -day) %>% 
  relocate (year, month, president) 
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp = 
  read_csv("./fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, into = c("month", "day", "year")) %>% 
  mutate(month = recode(month, `1` = "Jan", `2` = "Feb", `3` = "Mar", `4` = "Apr", `5` = "May", `6` = "Jun", `7` = "Jul", `8` = "Aug", `9` = "Sep", `10` = "Oct", `11` = "Nov", `12` = "Dec")) %>% 
  mutate(year = ifelse(year >= 50, paste0("19", year), paste0("20", year))) %>% 
  relocate(year, month) %>% 
  select(-day) 
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemployment = 
  read_csv("./fivethirtyeight_datasets/unemployment.csv") %>% 
  pivot_longer(
    Jan:Dec,
    names_to = "month"
  ) %>% 
  rename_with(tolower, everything()) 
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

converting variable year from numeric to character data type in
unemployment dataset

``` r
unemployment$year <- as.character(unemployment$year)
```

merging snp and pols_month

``` r
pols_snp_merge = left_join(pols_month, snp, by = c("year", "month"))
```

merging unemployment into our merged dataset

``` r
fivethirtyeight_merge = full_join(pols_snp_merge, unemployment, by = c("year", "month"), copy = TRUE)
```

**description:** The pol_month data set contains 822 observations of 9
variables regarding number republican or democratic national politicians
associated with the month & year. The snp data set contains 787
observations of 3 variables relating to the closing value of the S&P
stock index associated month & year. The unemployment data set contains
816 observations of 3 variables pertaining to the percentage of
unemployment associated with the month & year. When merging all three
data sets together, it creates a data set that contains 828 observations
of 12 variables, with information pertaining to unemployment percentage
and S&P stock index closing value, and whether the president during the
associated month & date was republican or democrat. The relevant years
with no missing information is from Jan 1950- Jun 2015. The key
variables to look at would be the year, president, close, and value.

## problem 2

importing and cleaning data

``` r
trash =  
  readxl::read_excel("./Trash_Wheel_Collection_Data.xlsx") %>% 
  janitor::clean_names() %>% 
  select(-15, -16) %>% 
  slice(-548) %>% 
  mutate(homes_powered = ((weight_tons*500)/1000)) %>% 
  mutate(trash_var = "mr.trash_wheel")
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
trash_wheel =
  readxl::read_excel("./Trash_Wheel_Collection_Data.xlsx", sheet = 2, range = "A3:M96", col_names = c("dumpster", "month", "year", "date", "weight_tons", "Volume (cubic yards)", "plastic_bottles", "polystyrene", "cigarette_butts", "glass_bottles", "grocery_bags", "chip_bags", "homes_powered")) %>% 
  janitor::clean_names() %>% 
  mutate(homes_powered = ((weight_tons*500)/1000)) %>% 
  mutate(trash_var = "prof_trash_wheel")

gwynnda =
  readxl::read_excel("./Trash_Wheel_Collection_Data.xlsx", sheet = 4) %>% 
  janitor::clean_names() %>% 
  mutate(homes_powered = ((weight_tons*500)/1000)) %>% 
  mutate(trash_var = "gwynnda")
```

converting

``` r
trash$year <- as.numeric(trash$year)
trash_wheel$year <- as.numeric(trash_wheel$year)
```

merging data set:

``` r
trash_tidy = 
  bind_rows(trash, trash_wheel, gwynnda) %>% 
  janitor::clean_names() %>% 
  relocate(dumpster, trash_var)
```

cigarette butts collected by Gwynnda in July 2021

``` r
gwynnda_july <- subset(gwynnda, month == "July" & year == "2021")
```

**description:** This data set contains estimated trash gathered from a
water-wheel vessel that removes trash from the Inner Harbor in
Baltimore, Maryland. It contains 749 and 16. Some key variables in this
data set includes `weight_tons`, `volumne_cubic_yards`, and
`homes_powered`. The total weight of trash collected by Professor Trash
Wheel was 190.12 tons. The total number of cigarette butts collected by
Gwynnda in July 2021 was 1.63^{4}

## problem 3

importing baseline data

``` r
baseline = 
  read_csv("./data_mci/MCI_baseline.csv", skip = 1, col_names = FALSE) %>%
  {colnames(.) <- as.character(.[1, ]); .[-1, ]} %>% 
  janitor::clean_names() %>% 
  mutate(sex = recode(sex, `1` = "male", `0` = "female")) %>% 
  mutate(apoe4 = recode(apoe4, `1` = "carrier", `0` = "non-carrier")) %>% 
  filter(age_at_onset != ".") 
```

    ## Rows: 484 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (6): X1, X2, X3, X4, X5, X6
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

converting age_at_onset variable into a numeric – was stored as
character factors in original file

``` r
baseline$age_at_onset = as.numeric(baseline$age_at_onset)  
```

proportion of women in the study who are apoe4 carriers:

``` r
baseline %>% 
  group_by(sex) %>% 
  summarize(prop_apoe4_carrier = mean(apoe4 == "carrier", na.rm = TRUE)) %>% 
  filter(sex == "female")
```

    ## # A tibble: 1 × 2
    ##   sex    prop_apoe4_carrier
    ##   <chr>               <dbl>
    ## 1 female              0.652

**description:** Because the first row in the data set was not the
variables, but was information of what the numeric values indicate, I
had to specify to R to skip the first row and read the second row as the
variable column. Additionally, I had to remove any missing data, coded
as “.”, since those individuals remained MCI free for the baseline data
set. 483 participants were recruited, however, only 97 developed MCI.
The average baseline age in this study was 70.2628866. The proportion of
women in the study who are APOE4 carriers is ~0.652.

importing longitudinally observed biomarker values

``` r
amyloid = 
  read_csv("./data_mci/mci_amyloid.csv", skip = 1, col_names = FALSE) %>%
  {colnames(.) <- as.character(.[1, ]); .[-1, ]} %>% 
  janitor::clean_names() %>% 
  filter(complete.cases(.)) %>% 
  filter_all(all_vars(!grepl("Na", .))) %>% 
  mutate(id = study_id) %>% 
  select (id, everything(), -study_id)
```

    ## Rows: 488 Columns: 6
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (6): X1, X2, X3, X4, X5, X6
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

**description:** Similar to the baseline data set, the amyloid data
set’s first row gave information of the units, i.e. time in years
elapsed since the study baseline to the visit where amyloid had a 42/40
ratio. I had to specify to R to skip the first row and read the second
row as the variable. Additionally, I had to remove any participants that
had missing variables, including those coded as “Na” and those that were
left blank. Thus the data set only contains participants with data at
baseline and every time point (in years). I also had to change the
variable `study_id` to `id` so that it would match the baseline data
variables.

Because the amyloid data set has 340 participants, whereas the baseline
data set only has 97, we can tell that there is more data for amyloid
than there are baseline measurements.

merging data set together:

``` r
mci_merge = merge(baseline, amyloid, by = "id")
```

**description:** In the mci_merge data set, I combined the baseline and
amyloid data set together by variable `id` to ensure that only that
appear in both datasets are retained. After merging, there are 66
participants left in the study.

``` r
p8105_hw2_nn2477 <- "/Users/nhunguyen/Desktop/P8150/p8105_hw2_nn2477/mci_merge.csv"
write.csv(mci_merge, file = p8105_hw2_nn2477, row.names = FALSE)
```
